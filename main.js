/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => DragAndDropBlocksPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/DragVisuals/DragVisuals.ts
var import_obsidian = require("obsidian");

// src/DragVisuals/DragPlaceholder.ts
var DragPlaceholder = class {
  constructor() {
    this.currentPosition = null;
    this.targetLine = null;
    this.sourceLineNumber = null;
    this.element = this.createDragPlaceholderElement();
    document.body.appendChild(this.element);
  }
  createDragPlaceholderElement() {
    const dragPlaceholder = document.createElement("div");
    dragPlaceholder.className = "drag-placeholder";
    dragPlaceholder.style.position = "absolute";
    dragPlaceholder.style.height = "2px";
    dragPlaceholder.style.backgroundColor = "var(--interactive-accent)";
    dragPlaceholder.style.display = "none";
    dragPlaceholder.style.zIndex = "1000";
    return dragPlaceholder;
  }
  getFrontmatterLineCount(doc) {
    let lineCount = 0;
    const firstLine = doc.line(1);
    if (firstLine.text.trim() !== "---") {
      return 0;
    }
    for (let i = 2; i <= doc.lines; i++) {
      lineCount++;
      const line = doc.line(i);
      if (line.text.trim() === "---") {
        return lineCount + 1;
      }
    }
    return 0;
  }
  showDragPlaceholder(view, pos, sourceLineNumber) {
    const doc = view.state.doc;
    const frontmatterLineCount = this.getFrontmatterLineCount(doc);
    const firstContentLineNumber = frontmatterLineCount + 1;
    const line = doc.lineAt(pos);
    let placeholderPos;
    let targetLineNumber;
    if (line.number < firstContentLineNumber) {
      placeholderPos = doc.line(firstContentLineNumber).from;
      targetLineNumber = firstContentLineNumber;
    } else {
      const lineStart = line.from;
      const lineEnd = line.to;
      const lineMiddle = lineStart + Math.floor((lineEnd - lineStart) / 2);
      if (pos <= lineMiddle) {
        placeholderPos = lineStart;
        targetLineNumber = line.number;
      } else {
        placeholderPos = lineEnd;
        targetLineNumber = line.number + 1;
      }
    }
    targetLineNumber = Math.min(targetLineNumber, doc.lines + 1);
    const rect = view.coordsAtPos(placeholderPos);
    if (!rect)
      return;
    const lineElement = view.dom.querySelector(".cm-line");
    if (!lineElement)
      return;
    const lineRect = lineElement.getBoundingClientRect();
    this.element.style.display = "block";
    this.element.style.left = `${lineRect.left}px`;
    this.element.style.width = `${lineRect.width}px`;
    this.element.style.height = "2px";
    if (targetLineNumber === firstContentLineNumber) {
      const firstContentLineRect = view.coordsAtPos(placeholderPos);
      if (firstContentLineRect) {
        this.element.style.top = `${firstContentLineRect.top - 2}px`;
      }
    } else if (targetLineNumber > doc.lines) {
      this.element.style.top = `${rect.bottom + 2}px`;
    } else {
      const currentLineRect = view.coordsAtPos(line.from);
      const nextLineRect = view.coordsAtPos(doc.line(targetLineNumber).from);
      if (currentLineRect && nextLineRect) {
        this.element.style.top = `${(currentLineRect.bottom + nextLineRect.top) / 2}px`;
      }
    }
    this.currentPosition = placeholderPos;
    this.targetLine = targetLineNumber;
    this.sourceLineNumber = sourceLineNumber;
  }
  hideDragPlaceholder() {
    this.element.style.display = "none";
    this.currentPosition = null;
    this.targetLine = null;
    this.sourceLineNumber = null;
  }
  getPlaceholderPosition() {
    return this.currentPosition;
  }
  getTargetLine() {
    return this.targetLine;
  }
  getSourceLineNumber() {
    return this.sourceLineNumber;
  }
};

// src/DragVisuals/DragHandleManager.ts
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var DragHandleWidget = class extends import_view.WidgetType {
  toDOM() {
    const span = document.createElement("span");
    span.className = "cm-drag-handler-container";
    span.setAttribute("draggable", "true");
    span.setAttribute("contenteditable", "false");
    span.innerHTML = `
            <span class="clickable-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-grip-vertical">
                    <circle cx="9" cy="12" r="1"></circle>
                    <circle cx="9" cy="5" r="1"></circle>
                    <circle cx="9" cy="19" r="1"></circle>
                    <circle cx="15" cy="12" r="1"></circle>
                    <circle cx="15" cy="5" r="1"></circle>
                    <circle cx="15" cy="19" r="1"></circle>
                </svg>
            </span>
        `;
    return span;
  }
};
var addDragHandle = import_state.StateEffect.define();
var setDraggingLine = import_state.StateEffect.define();
var dragHandleField = import_state.StateField.define({
  create() {
    return import_view.Decoration.none;
  },
  update(handles, tr) {
    handles = handles.map(tr.changes);
    for (let e of tr.effects) {
      if (e.is(addDragHandle)) {
        handles = handles.update({
          add: [import_view.Decoration.widget({
            widget: new DragHandleWidget(),
            side: -1
          }).range(e.value.from)]
        });
      }
    }
    return handles;
  },
  provide: (f) => import_view.EditorView.decorations.from(f)
});
var draggingLineField = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    for (let e of tr.effects) {
      if (e.is(setDraggingLine)) {
        return e.value;
      }
    }
    return value;
  },
  provide: (f) => import_view.EditorView.decorations.from(f, (value) => {
    return (view) => {
      if (value === null)
        return import_view.Decoration.none;
      let line = view.state.doc.line(value);
      return import_view.Decoration.set(import_view.Decoration.line({ class: "cm-dragging-line" }).range(line.from));
    };
  })
});
var dragHandlePlugin = import_view.ViewPlugin.fromClass(class {
  constructor(view) {
    this.decorations = this.createDecorations(view);
  }
  update(update) {
    if (update.docChanged || update.viewportChanged) {
      this.decorations = this.createDecorations(update.view);
    }
  }
  createDecorations(view) {
    let widgets = [];
    for (let { from, to } of view.visibleRanges) {
      for (let pos = from; pos <= to; ) {
        let line = view.state.doc.lineAt(pos);
        widgets.push(import_view.Decoration.widget({
          widget: new DragHandleWidget(),
          side: -1
        }).range(line.from));
        pos = line.to + 1;
      }
    }
    return import_view.Decoration.set(widgets);
  }
}, {
  decorations: (v) => v.decorations
});

// src/DragVisuals/DragVisuals.ts
var DragVisuals = class {
  constructor(app) {
    this.app = app;
    this.dragPlaceholder = new DragPlaceholder();
  }
  showDragPlaceholder(view, pos, sourceLineNumber) {
    this.dragPlaceholder.showDragPlaceholder(view, pos, sourceLineNumber);
  }
  hideDragPlaceholder() {
    this.dragPlaceholder.hideDragPlaceholder();
  }
  createDragPreview(text, event) {
    var _a;
    const dragImage = document.createElement("div");
    dragImage.textContent = text.slice(0, 20) + "...";
    dragImage.className = "drag-preview";
    document.body.appendChild(dragImage);
    (_a = event.dataTransfer) == null ? void 0 : _a.setDragImage(dragImage, 0, 0);
    setTimeout(() => document.body.removeChild(dragImage), 0);
  }
  getEditorView() {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (!view)
      return null;
    return view.editor.cm;
  }
  setDraggingLine(view, lineNumber) {
    view.dispatch({
      effects: setDraggingLine.of(lineNumber)
    });
  }
  static getDragExtensions() {
    return [
      dragHandleField,
      draggingLineField,
      dragHandlePlugin
    ];
  }
  getPlaceholderPosition() {
    return this.dragPlaceholder.getPlaceholderPosition();
  }
  getTargetLine() {
    return this.dragPlaceholder.getTargetLine();
  }
  getSourceLineNumber() {
    return this.dragPlaceholder.getSourceLineNumber();
  }
};

// src/BlockMover.ts
var import_state2 = require("@codemirror/state");
var BlockMover = class {
  static moveBlock(view, fromLine, toLine) {
    const doc = view.state.doc;
    const totalLines = doc.lines;
    fromLine = Math.max(1, Math.min(fromLine, totalLines));
    toLine = Math.max(1, Math.min(toLine, totalLines + 1));
    if (toLine === fromLine + 1 || fromLine === toLine) {
      return;
    }
    const fromLineContent = doc.line(fromLine);
    const lineContent = fromLineContent.text;
    let changes = [];
    let insertPos;
    let newCursorPos;
    if (toLine > fromLine) {
      if (toLine > totalLines) {
        const lastLine = doc.line(totalLines);
        insertPos = lastLine.to;
        changes = [
          { from: insertPos, insert: "\n" + lineContent },
          { from: fromLineContent.from, to: fromLineContent.to + (fromLine === totalLines ? 0 : 1), insert: "" }
        ];
        newCursorPos = insertPos + lineContent.length + 1;
      } else {
        const targetLine = doc.line(toLine - 1);
        insertPos = targetLine.to;
        changes = [
          { from: insertPos, insert: "\n" + lineContent },
          { from: fromLineContent.from, to: fromLineContent.to + 1, insert: "" }
        ];
        newCursorPos = insertPos + lineContent.length + 1;
      }
    } else {
      const targetLine = doc.line(toLine - 1);
      insertPos = targetLine.to;
      if (fromLine === totalLines) {
        const secondLastLine = doc.line(totalLines - 1);
        changes = [
          { from: insertPos, insert: "\n" + lineContent },
          { from: secondLastLine.to, to: doc.length }
        ];
      } else {
        changes = [
          { from: insertPos, insert: "\n" + lineContent },
          { from: fromLineContent.from, to: fromLineContent.to + 1, insert: "" }
        ];
      }
      newCursorPos = insertPos + lineContent.length + 1;
    }
    try {
      view.dispatch({
        changes,
        selection: import_state2.EditorSelection.cursor(Math.min(newCursorPos, doc.length))
      });
    } catch (error) {
    }
  }
};

// src/utils.ts
var import_obsidian2 = require("obsidian");
function getEditorView(app) {
  const view = app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
  if (!view)
    return null;
  return view.editor.cm;
}

// main.ts
var DragAndDropBlocksPlugin = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.draggingStartPos = null;
    this.sourceLineNumber = null;
  }
  async onload() {
    this.dragVisuals = new DragVisuals(this.app);
    this.registerEditorExtension([
      dragHandleField,
      draggingLineField,
      dragHandlePlugin,
      ...DragVisuals.getDragExtensions()
    ]);
    this.addDragAndDropListeners();
  }
  onunload() {
  }
  addDragAndDropListeners() {
    this.registerDomEvent(document, "dragstart", this.onDragStart.bind(this));
    this.registerDomEvent(document, "dragover", this.onDragOver.bind(this));
    this.registerDomEvent(document, "drop", this.onDrop.bind(this));
    this.registerDomEvent(document, "dragend", this.onDragEnd.bind(this));
  }
  onDragStart(event) {
    console.clear();
    const target = event.target;
    if (!target.classList.contains("cm-drag-handler-container"))
      return;
    const view = getEditorView(this.app);
    if (!view)
      return;
    const pos = view.posAtDOM(target);
    if (pos === null)
      return;
    const line = view.state.doc.lineAt(pos);
    this.draggingStartPos = line.from;
    this.sourceLineNumber = line.number;
    event.dataTransfer.effectAllowed = "move";
    this.dragVisuals.createDragPreview(line.text, event);
    this.dragVisuals.setDraggingLine(view, line.number);
  }
  onDragOver(event) {
    event.preventDefault();
    const view = getEditorView(this.app);
    if (!view || this.sourceLineNumber === null)
      return;
    const pos = view.posAtCoords({ x: event.clientX, y: event.clientY });
    if (pos === null)
      return;
    this.dragVisuals.showDragPlaceholder(view, pos, this.sourceLineNumber);
  }
  onDrop(event) {
    event.preventDefault();
    const view = getEditorView(this.app);
    if (!view) {
      return;
    }
    const targetLine = this.dragVisuals.getTargetLine();
    const sourceLineNumber = this.dragVisuals.getSourceLineNumber();
    if (targetLine === null || sourceLineNumber === null) {
      return;
    }
    if (sourceLineNumber !== targetLine && targetLine !== sourceLineNumber + 1) {
      BlockMover.moveBlock(view, sourceLineNumber, targetLine);
    }
    this.dragVisuals.hideDragPlaceholder();
    this.dragVisuals.setDraggingLine(view, null);
  }
  getFrontmatterEndPosition(doc) {
    const firstLine = doc.line(1);
    if (firstLine.text.trim() !== "---") {
      return 0;
    }
    for (let i = 2; i <= doc.lines; i++) {
      const line = doc.line(i);
      if (line.text.trim() === "---") {
        return line.to;
      }
    }
    return 0;
  }
  shouldInsertBefore(view, pos) {
    const line = view.state.doc.lineAt(pos);
    const lineStart = line.from;
    const lineMiddle = lineStart + Math.floor(line.length / 2);
    return pos < lineMiddle;
  }
  onDragEnd(event) {
    const view = getEditorView(this.app);
    if (!view)
      return;
    this.dragVisuals.hideDragPlaceholder();
    this.dragVisuals.setDraggingLine(view, null);
    this.draggingStartPos = null;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvRHJhZ1Zpc3VhbHMvRHJhZ1Zpc3VhbHMudHMiLCAic3JjL0RyYWdWaXN1YWxzL0RyYWdQbGFjZWhvbGRlci50cyIsICJzcmMvRHJhZ1Zpc3VhbHMvRHJhZ0hhbmRsZU1hbmFnZXIudHMiLCAic3JjL0Jsb2NrTW92ZXIudHMiLCAic3JjL3V0aWxzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSAnQGNvZGVtaXJyb3Ivdmlldyc7XG5pbXBvcnQgeyBEcmFnVmlzdWFscyB9IGZyb20gJy4vc3JjL0RyYWdWaXN1YWxzL0RyYWdWaXN1YWxzJztcbmltcG9ydCB7IGRyYWdIYW5kbGVGaWVsZCwgZHJhZ2dpbmdMaW5lRmllbGQsIGRyYWdIYW5kbGVQbHVnaW4gfSBmcm9tICcuL3NyYy9EcmFnVmlzdWFscy9EcmFnSGFuZGxlTWFuYWdlcic7XG5pbXBvcnQgeyBCbG9ja01vdmVyIH0gZnJvbSAnLi9zcmMvQmxvY2tNb3Zlcic7XG5pbXBvcnQgeyBnZXRFZGl0b3JWaWV3IH0gZnJvbSAnLi9zcmMvdXRpbHMnO1xuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERyYWdBbmREcm9wQmxvY2tzUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBwcml2YXRlIGRyYWdWaXN1YWxzOiBEcmFnVmlzdWFscztcbiAgICBwcml2YXRlIGRyYWdnaW5nU3RhcnRQb3M6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgc291cmNlTGluZU51bWJlcjogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cblxuICAgIC8vIDEuIFx1NjNEMlx1NEVGNlx1NTJBMFx1OEY3RFxuICAgIGFzeW5jIG9ubG9hZCgpIHtcblxuICAgICAgICB0aGlzLmRyYWdWaXN1YWxzID0gbmV3IERyYWdWaXN1YWxzKHRoaXMuYXBwKTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFtcbiAgICAgICAgICAgIGRyYWdIYW5kbGVGaWVsZCxcbiAgICAgICAgICAgIGRyYWdnaW5nTGluZUZpZWxkLFxuICAgICAgICAgICAgZHJhZ0hhbmRsZVBsdWdpbixcbiAgICAgICAgICAgIC4uLkRyYWdWaXN1YWxzLmdldERyYWdFeHRlbnNpb25zKClcbiAgICAgICAgXSk7XG5cbiAgICAgICAgLy8gMS4xIFx1NkRGQlx1NTJBMFx1NjJENlx1NTJBOFx1NTQ4Q1x1NjUzRVx1N0Y2RVx1NEU4Qlx1NEVGNlx1NzZEMVx1NTQyQ1x1NTY2OFxuICAgICAgICB0aGlzLmFkZERyYWdBbmREcm9wTGlzdGVuZXJzKCk7XG5cblxuICAgIH1cblxuICAgIC8vIDIuIFx1NjNEMlx1NEVGNlx1NTM3OFx1OEY3RFxuICAgIG9udW5sb2FkKCkge1xuICAgIH1cblxuICAgIC8vIDMuIFx1NkRGQlx1NTJBMFx1NjJENlx1NjUzRVx1NzZEMVx1NTQyQ1x1NTY2OFxuICAgIHByaXZhdGUgYWRkRHJhZ0FuZERyb3BMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2RyYWdzdGFydCcsIHRoaXMub25EcmFnU3RhcnQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2RyYWdvdmVyJywgdGhpcy5vbkRyYWdPdmVyLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsICdkcm9wJywgdGhpcy5vbkRyb3AuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2RyYWdlbmQnLCB0aGlzLm9uRHJhZ0VuZC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cblxuICAgIC8vIDQuIFx1NjJENlx1NTJBOFx1NUYwMFx1NTlDQlx1NEU4Qlx1NEVGNlx1NTkwNFx1NzQwNiBcbiAgICBwcml2YXRlIG9uRHJhZ1N0YXJ0KGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICAgICAgY29uc29sZS5jbGVhcigpO1xuXG4gICAgICAgIC8vIDQuMSBcdTgzQjdcdTUzRDZcdTYyRDZcdTUyQThcdTc2RUVcdTY4MDdcdTUxNDNcdTdEMjBcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAvLyA0LjIgXHU1OTgyXHU2NzlDXHU3NkVFXHU2ODA3XHU0RTBEXHU2NjJGXHU2MkQ2XHU1MkE4XHU2MjRCXHU2N0M0XHU1QkI5XHU1NjY4XHVGRjBDXHU1MjE5XHU5MDAwXHU1MUZBXG4gICAgICAgIGlmICghdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY20tZHJhZy1oYW5kbGVyLWNvbnRhaW5lcicpKSByZXR1cm47XG5cbiAgICAgICAgLy8gNC4zIFx1ODNCN1x1NTNENlx1N0YxNlx1OEY5MVx1NTY2OFx1ODlDNlx1NTZGRVxuICAgICAgICBjb25zdCB2aWV3ID0gZ2V0RWRpdG9yVmlldyh0aGlzLmFwcCk7XG4gICAgICAgIC8vIDQuNCBcdTU5ODJcdTY3OUNcdTY1RTBcdTZDRDVcdTgzQjdcdTUzRDZcdTg5QzZcdTU2RkVcdUZGMENcdTUyMTlcdTkwMDBcdTUxRkFcbiAgICAgICAgaWYgKCF2aWV3KSByZXR1cm47XG5cbiAgICAgICAgLy8gNC41IFx1ODNCN1x1NTNENlx1NzZFRVx1NjgwN1x1NTE0M1x1N0QyMFx1NTcyOFx1NjU4N1x1Njg2M1x1NEUyRFx1NzY4NFx1NEY0RFx1N0Y2RVxuICAgICAgICBjb25zdCBwb3MgPSB2aWV3LnBvc0F0RE9NKHRhcmdldCk7XG4gICAgICAgIC8vIDQuNiBcdTU5ODJcdTY3OUNcdTY1RTBcdTZDRDVcdTgzQjdcdTUzRDZcdTRGNERcdTdGNkVcdUZGMENcdTUyMTlcdTkwMDBcdTUxRkFcbiAgICAgICAgaWYgKHBvcyA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgIC8vIDQuNyBcdTgzQjdcdTUzRDZcdTYyRDZcdTUyQThcdTVGMDBcdTU5Q0JcdTc2ODRcdTg4NENcbiAgICAgICAgY29uc3QgbGluZSA9IHZpZXcuc3RhdGUuZG9jLmxpbmVBdChwb3MpO1xuICAgICAgICAvLyA0LjggXHU4QkIwXHU1RjU1XHU2MkQ2XHU1MkE4XHU1RjAwXHU1OUNCXHU3Njg0XHU0RjREXHU3RjZFXG4gICAgICAgIHRoaXMuZHJhZ2dpbmdTdGFydFBvcyA9IGxpbmUuZnJvbTtcbiAgICAgICAgdGhpcy5zb3VyY2VMaW5lTnVtYmVyID0gbGluZS5udW1iZXI7XG5cbiAgICAgICAgLy8gNC45IFx1OEJCRVx1N0Y2RVx1NjJENlx1NTJBOFx1NjU0OFx1Njc5Q1x1NEUzQVx1NzlGQlx1NTJBOFxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSc7XG5cbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2MkQ2XHU1MkE4XHU5ODg0XHU4OUM4XG4gICAgICAgIHRoaXMuZHJhZ1Zpc3VhbHMuY3JlYXRlRHJhZ1ByZXZpZXcobGluZS50ZXh0LCBldmVudCk7XG4gICAgICAgIC8vIFx1OEJCRVx1N0Y2RVx1NkI2M1x1NTcyOFx1NjJENlx1NTJBOFx1NzY4NFx1ODg0Q1xuICAgICAgICB0aGlzLmRyYWdWaXN1YWxzLnNldERyYWdnaW5nTGluZSh2aWV3LCBsaW5lLm51bWJlcik7XG4gICAgfVxuXG5cbiAgICAvLyA1LiBcdTYyRDZcdTUyQThcdThGQzdcdTdBMEJcdTRFMkRcdTRFOEJcdTRFRjZcdTU5MDRcdTc0MDZcdUZGMENcdTYyRDZcdTUyQThcdThGQzdcdTdBMEJcdTRFMkRcdTc2ODRcdTg5QzZcdTg5QzlcdTUzQ0RcdTk5ODhcbiAgICBwcml2YXRlIG9uRHJhZ092ZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB2aWV3ID0gZ2V0RWRpdG9yVmlldyh0aGlzLmFwcCk7XG4gICAgICAgIGlmICghdmlldyB8fCB0aGlzLnNvdXJjZUxpbmVOdW1iZXIgPT09IG51bGwpIHJldHVybjtcblxuICAgICAgICBjb25zdCBwb3MgPSB2aWV3LnBvc0F0Q29vcmRzKHsgeDogZXZlbnQuY2xpZW50WCwgeTogZXZlbnQuY2xpZW50WSB9KTtcbiAgICAgICAgaWYgKHBvcyA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuZHJhZ1Zpc3VhbHMuc2hvd0RyYWdQbGFjZWhvbGRlcih2aWV3LCBwb3MsIHRoaXMuc291cmNlTGluZU51bWJlcik7XG4gICAgfVxuXG4gICAgLy8gNi4gXHU2MkQ2XHU1MkE4XHU3RUQzXHU2NzVGXHU0RThCXHU0RUY2XHU1OTA0XHU3NDA2XHVGRjBDXHU1QjgzXHU1MUIzXHU1QjlBXHU0RTg2XHU2MkQ2XHU1MkE4XHU3RUQzXHU2NzVGXHU1NDBFXHU1NzU3XHU3Njg0XHU2NzAwXHU3RUM4XHU0RjREXHU3RjZFXG4gICAgcHJpdmF0ZSBvbkRyb3AoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIFxuICAgICAgICBjb25zdCB2aWV3ID0gZ2V0RWRpdG9yVmlldyh0aGlzLmFwcCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIGNvbnN0IHRhcmdldExpbmUgPSB0aGlzLmRyYWdWaXN1YWxzLmdldFRhcmdldExpbmUoKTtcbiAgICAgICAgY29uc3Qgc291cmNlTGluZU51bWJlciA9IHRoaXMuZHJhZ1Zpc3VhbHMuZ2V0U291cmNlTGluZU51bWJlcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRhcmdldExpbmUgPT09IG51bGwgfHwgc291cmNlTGluZU51bWJlciA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIC8vIDYuNSBcdTY4QzBcdTY3RTVcdTY2MkZcdTU0MjZcdTk3MDBcdTg5ODFcdTc5RkJcdTUyQThcbiAgICAgICAgaWYgKHNvdXJjZUxpbmVOdW1iZXIgIT09IHRhcmdldExpbmUgJiYgdGFyZ2V0TGluZSAhPT0gc291cmNlTGluZU51bWJlciArIDEpIHtcbiAgICAgICAgICAgIEJsb2NrTW92ZXIubW92ZUJsb2NrKHZpZXcsIHNvdXJjZUxpbmVOdW1iZXIsIHRhcmdldExpbmUpO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIHRoaXMuZHJhZ1Zpc3VhbHMuaGlkZURyYWdQbGFjZWhvbGRlcigpO1xuICAgICAgICB0aGlzLmRyYWdWaXN1YWxzLnNldERyYWdnaW5nTGluZSh2aWV3LCBudWxsKTtcbiAgICB9XG4gICAgXG4gICAgLy8gNy4gXHU4M0I3XHU1M0Q2XHU2NTg3XHU2ODYzXHU1QzVFXHU2MDI3XHU0RkUxXHU2MDZGXHU3RUQzXHU2NzVGXHU0RjREXHU3RjZFXG4gICAgcHJpdmF0ZSBnZXRGcm9udG1hdHRlckVuZFBvc2l0aW9uKGRvYzogYW55KTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgZmlyc3RMaW5lID0gZG9jLmxpbmUoMSk7XG4gICAgICAgIGlmIChmaXJzdExpbmUudGV4dC50cmltKCkgIT09ICctLS0nKSB7XG4gICAgICAgICAgICByZXR1cm4gMDsgLy8gXHU2Q0ExXHU2NzA5XHU2NTg3XHU2ODYzXHU1QzVFXHU2MDI3XHU0RkUxXHU2MDZGXG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDI7IGkgPD0gZG9jLmxpbmVzOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBkb2MubGluZShpKTtcbiAgICAgICAgICAgIGlmIChsaW5lLnRleHQudHJpbSgpID09PSAnLS0tJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lLnRvO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwOyAvLyBcdTY3MkFcdTYyN0VcdTUyMzBcdTdFRDNcdTY3NUZcdTc2ODRcdTY1ODdcdTY4NjNcdTVDNUVcdTYwMjdcdTRGRTFcdTYwNkZcdTUyMDZcdTk2OTRcdTdCMjZcbiAgICB9XG5cbiAgICAvLyA4LiBcdTUyMjRcdTY1QURcdTY2MkZcdTU0MjZcdTVFOTRcdThCRTVcdTU3MjhcdTVGNTNcdTUyNERcdTRGNERcdTdGNkVcdTRFNEJcdTUyNERcdTYzRDJcdTUxNjVcbiAgICBwcml2YXRlIHNob3VsZEluc2VydEJlZm9yZSh2aWV3OiBFZGl0b3JWaWV3LCBwb3M6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBsaW5lID0gdmlldy5zdGF0ZS5kb2MubGluZUF0KHBvcyk7XG4gICAgICAgIGNvbnN0IGxpbmVTdGFydCA9IGxpbmUuZnJvbTtcbiAgICAgICAgY29uc3QgbGluZU1pZGRsZSA9IGxpbmVTdGFydCArIE1hdGguZmxvb3IobGluZS5sZW5ndGggLyAyKTtcbiAgICAgICAgcmV0dXJuIHBvcyA8IGxpbmVNaWRkbGU7XG4gICAgfVxuXG4gICAgLy8gOS4gXHU2MkQ2XHU1MkE4XHU3RUQzXHU2NzVGXHU0RThCXHU0RUY2XHU1OTA0XHU3NDA2XG4gICAgcHJpdmF0ZSBvbkRyYWdFbmQoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICBjb25zdCB2aWV3ID0gZ2V0RWRpdG9yVmlldyh0aGlzLmFwcCk7XG4gICAgICAgIGlmICghdmlldykgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuZHJhZ1Zpc3VhbHMuaGlkZURyYWdQbGFjZWhvbGRlcigpO1xuICAgICAgICB0aGlzLmRyYWdWaXN1YWxzLnNldERyYWdnaW5nTGluZSh2aWV3LCBudWxsKTtcblxuICAgICAgICB0aGlzLmRyYWdnaW5nU3RhcnRQb3MgPSBudWxsO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgRWRpdG9yVmlldywgV2lkZ2V0VHlwZSwgVmlld1VwZGF0ZSwgVmlld1BsdWdpbiwgRGVjb3JhdGlvblNldCwgRGVjb3JhdGlvbiB9IGZyb20gJ0Bjb2RlbWlycm9yL3ZpZXcnO1xuaW1wb3J0IHsgU3RhdGVGaWVsZCwgU3RhdGVFZmZlY3QsIEVkaXRvclN0YXRlIH0gZnJvbSAnQGNvZGVtaXJyb3Ivc3RhdGUnO1xuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IERyYWdQbGFjZWhvbGRlciB9IGZyb20gJy4vRHJhZ1BsYWNlaG9sZGVyJztcbmltcG9ydCB7IGRyYWdIYW5kbGVGaWVsZCwgZHJhZ2dpbmdMaW5lRmllbGQsIGRyYWdIYW5kbGVQbHVnaW4sIHNldERyYWdnaW5nTGluZSB9IGZyb20gJy4vRHJhZ0hhbmRsZU1hbmFnZXInO1xuXG5leHBvcnQgY2xhc3MgRHJhZ1Zpc3VhbHMge1xuICAgIHByaXZhdGUgYXBwOiBBcHA7XG4gICAgcHJpdmF0ZSBkcmFnUGxhY2Vob2xkZXI6IERyYWdQbGFjZWhvbGRlcjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwKSB7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmRyYWdQbGFjZWhvbGRlciA9IG5ldyBEcmFnUGxhY2Vob2xkZXIoKTtcbiAgICB9XG5cbiAgICAvLyAxLiBcdTY2M0VcdTc5M0FcdTYyRDZcdTUyQThcdTUzNjBcdTRGNERcdTdCMjZcbiAgICBzaG93RHJhZ1BsYWNlaG9sZGVyKHZpZXc6IEVkaXRvclZpZXcsIHBvczogbnVtYmVyLCBzb3VyY2VMaW5lTnVtYmVyOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5kcmFnUGxhY2Vob2xkZXIuc2hvd0RyYWdQbGFjZWhvbGRlcih2aWV3LCBwb3MsIHNvdXJjZUxpbmVOdW1iZXIpO1xuICAgIH1cblxuICAgIC8vIDIuIFx1OTY5MFx1ODVDRlx1NjJENlx1NTJBOFx1NTM2MFx1NEY0RFx1N0IyNlxuICAgIGhpZGVEcmFnUGxhY2Vob2xkZXIoKSB7XG4gICAgICAgIHRoaXMuZHJhZ1BsYWNlaG9sZGVyLmhpZGVEcmFnUGxhY2Vob2xkZXIoKTtcbiAgICB9XG5cblxuICAgIC8vIDEuIFx1NjVCMFx1NTg5RVx1NjVCOVx1NkNENVx1RkYxQVx1NTIxQlx1NUVGQVx1NjJENlx1NTJBOFx1OTg4NFx1ODlDOFxuICAgIGNyZWF0ZURyYWdQcmV2aWV3KHRleHQ6IHN0cmluZywgZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBkcmFnSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZHJhZ0ltYWdlLnRleHRDb250ZW50ID0gdGV4dC5zbGljZSgwLCAyMCkgKyAnLi4uJztcbiAgICAgICAgZHJhZ0ltYWdlLmNsYXNzTmFtZSA9ICdkcmFnLXByZXZpZXcnO1xuICAgICAgICBcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkcmFnSW1hZ2UpO1xuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXI/LnNldERyYWdJbWFnZShkcmFnSW1hZ2UsIDAsIDApO1xuICAgICAgICBcbiAgICAgICAgLy8gXHU0RjdGXHU3NTI4IHNldFRpbWVvdXQgXHU2NzY1XHU3ODZFXHU0RkREXHU2MkQ2XHU1MkE4XHU1RjAwXHU1OUNCXHU1NDBFXHU1MThEXHU3OUZCXHU5NjY0XHU5ODg0XHU4OUM4XHU1MTQzXHU3RDIwXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkcmFnSW1hZ2UpLCAwKTtcbiAgICB9XG5cblxuXG4gICAgLy8gMy4gXHU4M0I3XHU1M0Q2XHU3RjE2XHU4RjkxXHU1NjY4XHU4OUM2XHU1NkZFXG4gICAgZ2V0RWRpdG9yVmlldygpOiBFZGl0b3JWaWV3IHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIXZpZXcpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gKHZpZXcuZWRpdG9yIGFzIGFueSkuY207XG4gICAgfVxuXG4gICAgLy8gNC4gXHU4QkJFXHU3RjZFXHU2MkQ2XHU1MkE4XHU4ODRDXG4gICAgc2V0RHJhZ2dpbmdMaW5lKHZpZXc6IEVkaXRvclZpZXcsIGxpbmVOdW1iZXI6IG51bWJlciB8IG51bGwpIHtcbiAgICAgICAgdmlldy5kaXNwYXRjaCh7XG4gICAgICAgICAgICBlZmZlY3RzOiBzZXREcmFnZ2luZ0xpbmUub2YobGluZU51bWJlcilcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gNS4gXHU4M0I3XHU1M0Q2XHU2MkQ2XHU1MkE4XHU3NkY4XHU1MTczXHU3Njg0XHU3RjE2XHU4RjkxXHU1NjY4XHU2MjY5XHU1QzU1XG4gICAgc3RhdGljIGdldERyYWdFeHRlbnNpb25zKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgZHJhZ0hhbmRsZUZpZWxkLFxuICAgICAgICAgICAgZHJhZ2dpbmdMaW5lRmllbGQsXG4gICAgICAgICAgICBkcmFnSGFuZGxlUGx1Z2luXG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgZ2V0UGxhY2Vob2xkZXJQb3NpdGlvbigpOiBudW1iZXIgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHJhZ1BsYWNlaG9sZGVyLmdldFBsYWNlaG9sZGVyUG9zaXRpb24oKTtcbiAgICB9XG5cbiAgICBnZXRUYXJnZXRMaW5lKCk6IG51bWJlciB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy5kcmFnUGxhY2Vob2xkZXIuZ2V0VGFyZ2V0TGluZSgpO1xuICAgIH1cblxuICAgIGdldFNvdXJjZUxpbmVOdW1iZXIoKTogbnVtYmVyIHwgbnVsbCB7XG4gICAgICAgIHJldHVybiB0aGlzLmRyYWdQbGFjZWhvbGRlci5nZXRTb3VyY2VMaW5lTnVtYmVyKCk7XG4gICAgfVxufVxuXG4vLyBcdTVCRkNcdTUxRkEgc2V0RHJhZ2dpbmdMaW5lIFx1NEVFNVx1NEZCRlx1NTE3Nlx1NEVENlx1NkEyMVx1NTc1N1x1NTNFRlx1NEVFNVx1NEY3Rlx1NzUyOFxuZXhwb3J0IHsgc2V0RHJhZ2dpbmdMaW5lIH07IiwgImltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tICdAY29kZW1pcnJvci92aWV3JztcblxuZXhwb3J0IGNsYXNzIERyYWdQbGFjZWhvbGRlciB7XG4gICAgcHJpdmF0ZSBlbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGN1cnJlbnRQb3NpdGlvbjogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSB0YXJnZXRMaW5lOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgICBwcml2YXRlIHNvdXJjZUxpbmVOdW1iZXI6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IHRoaXMuY3JlYXRlRHJhZ1BsYWNlaG9sZGVyRWxlbWVudCgpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVEcmFnUGxhY2Vob2xkZXJFbGVtZW50KCk6IEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3QgZHJhZ1BsYWNlaG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRyYWdQbGFjZWhvbGRlci5jbGFzc05hbWUgPSAnZHJhZy1wbGFjZWhvbGRlcic7XG4gICAgICAgIGRyYWdQbGFjZWhvbGRlci5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIGRyYWdQbGFjZWhvbGRlci5zdHlsZS5oZWlnaHQgPSAnMnB4JztcbiAgICAgICAgZHJhZ1BsYWNlaG9sZGVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpJztcbiAgICAgICAgZHJhZ1BsYWNlaG9sZGVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIGRyYWdQbGFjZWhvbGRlci5zdHlsZS56SW5kZXggPSAnMTAwMCc7XG4gICAgICAgIHJldHVybiBkcmFnUGxhY2Vob2xkZXI7XG4gICAgfVxuXG4gICAgLy8gXHU2QTIxXHU1NzU3XHU3RjE2XHU1M0Y3XHVGRjFBMVxuICAgIC8vIFx1NTI5Rlx1ODBGRFx1RkYxQVx1ODNCN1x1NTNENlx1NjU4N1x1Njg2M1x1NUM1RVx1NjAyN1x1RkYwOGZyb250bWF0dGVyXHVGRjA5XHU3Njg0XHU4ODRDXHU2NTcwXG4gICAgLy8gXHU4RjkzXHU1MTY1XHVGRjFBZG9jIChhbnkpIC0gXHU2NTg3XHU2ODYzXHU1QkY5XHU4QzYxXG4gICAgLy8gXHU4RjkzXHU1MUZBXHVGRjFBbnVtYmVyIC0gXHU2NTg3XHU2ODYzXHU1QzVFXHU2MDI3XHU3Njg0XHU4ODRDXHU2NTcwXG4gICAgcHJpdmF0ZSBnZXRGcm9udG1hdHRlckxpbmVDb3VudChkb2M6IGFueSk6IG51bWJlciB7XG4gICAgICAgIGxldCBsaW5lQ291bnQgPSAwO1xuICAgICAgICBjb25zdCBmaXJzdExpbmUgPSBkb2MubGluZSgxKTtcbiAgICAgICAgaWYgKGZpcnN0TGluZS50ZXh0LnRyaW0oKSAhPT0gJy0tLScpIHtcbiAgICAgICAgICAgIHJldHVybiAwOyAvLyBcdTZDQTFcdTY3MDlcdTY1ODdcdTY4NjNcdTVDNUVcdTYwMjdcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gMjsgaSA8PSBkb2MubGluZXM7IGkrKykge1xuICAgICAgICAgICAgbGluZUNvdW50Kys7XG4gICAgICAgICAgICBjb25zdCBsaW5lID0gZG9jLmxpbmUoaSk7XG4gICAgICAgICAgICBpZiAobGluZS50ZXh0LnRyaW0oKSA9PT0gJy0tLScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGluZUNvdW50ICsgMTsgLy8gKzEgXHU1MzA1XHU2MkVDXHU3RUQzXHU2NzVGXHU3Njg0IFwiLS0tXCIgXHU4ODRDXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7IC8vIFx1NjcyQVx1NjI3RVx1NTIzMFx1N0VEM1x1Njc1Rlx1NzY4NFx1NjU4N1x1Njg2M1x1NUM1RVx1NjAyN1x1NTIwNlx1OTY5NFx1N0IyNlxuICAgIH1cblxuICAgIC8vIFx1NkEyMVx1NTc1N1x1N0YxNlx1NTNGN1x1RkYxQTJcbiAgICAvLyBcdTUyOUZcdTgwRkRcdUZGMUFcdTY2M0VcdTc5M0FcdTYyRDZcdTUyQThcdTUzNjBcdTRGNERcdTdCMjZcbiAgICAvLyBcdThGOTNcdTUxNjVcdUZGMUF2aWV3IChFZGl0b3JWaWV3KSAtIFx1N0YxNlx1OEY5MVx1NTY2OFx1ODlDNlx1NTZGRSwgcG9zIChudW1iZXIpIC0gXHU1RjUzXHU1MjREXHU0RjREXHU3RjZFLCBzb3VyY2VMaW5lTnVtYmVyIChudW1iZXIpIC0gXHU2RTkwXHU4ODRDXHU1M0Y3XG4gICAgLy8gXHU4RjkzXHU1MUZBXHVGRjFBXHU2NUUwXG4gICAgc2hvd0RyYWdQbGFjZWhvbGRlcih2aWV3OiBFZGl0b3JWaWV3LCBwb3M6IG51bWJlciwgc291cmNlTGluZU51bWJlcjogbnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IGRvYyA9IHZpZXcuc3RhdGUuZG9jO1xuICAgICAgICBjb25zdCBmcm9udG1hdHRlckxpbmVDb3VudCA9IHRoaXMuZ2V0RnJvbnRtYXR0ZXJMaW5lQ291bnQoZG9jKTtcbiAgICAgICAgY29uc3QgZmlyc3RDb250ZW50TGluZU51bWJlciA9IGZyb250bWF0dGVyTGluZUNvdW50ICsgMTtcbiAgICAgICAgY29uc3QgbGluZSA9IGRvYy5saW5lQXQocG9zKTtcbiAgICAgICAgbGV0IHBsYWNlaG9sZGVyUG9zOiBudW1iZXI7XG4gICAgICAgIGxldCB0YXJnZXRMaW5lTnVtYmVyOiBudW1iZXI7XG5cbiAgICAgICAgaWYgKGxpbmUubnVtYmVyIDwgZmlyc3RDb250ZW50TGluZU51bWJlcikge1xuICAgICAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU3NkVFXHU2ODA3XHU0RjREXHU3RjZFXHU1NzI4XHU2NTg3XHU2ODYzXHU1QzVFXHU2MDI3XHU1MTg1XHVGRjBDXHU1QzA2XHU1MzYwXHU0RjREXHU3QjI2XHU2NTNFXHU1NzI4XHU3QjJDXHU0RTAwXHU0RTJBXHU1MTg1XHU1QkI5XHU4ODRDXHU3Njg0XHU5ODc2XHU5MEU4XG4gICAgICAgICAgICBwbGFjZWhvbGRlclBvcyA9IGRvYy5saW5lKGZpcnN0Q29udGVudExpbmVOdW1iZXIpLmZyb207XG4gICAgICAgICAgICB0YXJnZXRMaW5lTnVtYmVyID0gZmlyc3RDb250ZW50TGluZU51bWJlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFx1NTkwNFx1NzQwNlx1NjI0MFx1NjcwOVx1NTE3Nlx1NEVENlx1ODg0Q1x1RkYwQ1x1NTMwNVx1NjJFQ1x1N0E3QVx1NzY3RFx1ODg0Q1x1NTQ4Q1x1NjU4N1x1Njg2M1x1NjcyQlx1NUMzRVxuICAgICAgICAgICAgY29uc3QgbGluZVN0YXJ0ID0gbGluZS5mcm9tO1xuICAgICAgICAgICAgY29uc3QgbGluZUVuZCA9IGxpbmUudG87XG4gICAgICAgICAgICBjb25zdCBsaW5lTWlkZGxlID0gbGluZVN0YXJ0ICsgTWF0aC5mbG9vcigobGluZUVuZCAtIGxpbmVTdGFydCkgLyAyKTtcblxuICAgICAgICAgICAgaWYgKHBvcyA8PSBsaW5lTWlkZGxlKSB7XG4gICAgICAgICAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU1NzI4XHU4ODRDXHU3Njg0XHU0RTBBXHU1MzRBXHU5MEU4XHU1MjA2XHVGRjBDXHU1QzA2XHU1MzYwXHU0RjREXHU3QjI2XHU2NTNFXHU1NzI4XHU4ODRDXHU3Njg0XHU1RjAwXHU1OUNCXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJQb3MgPSBsaW5lU3RhcnQ7XG4gICAgICAgICAgICAgICAgdGFyZ2V0TGluZU51bWJlciA9IGxpbmUubnVtYmVyO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTU3MjhcdTg4NENcdTc2ODRcdTRFMEJcdTUzNEFcdTkwRThcdTUyMDZcdUZGMENcdTVDMDZcdTUzNjBcdTRGNERcdTdCMjZcdTY1M0VcdTU3MjhcdTRFMEJcdTRFMDBcdTg4NENcdTc2ODRcdTVGMDBcdTU5Q0JcbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlclBvcyA9IGxpbmVFbmQ7XG4gICAgICAgICAgICAgICAgdGFyZ2V0TGluZU51bWJlciA9IGxpbmUubnVtYmVyICsgMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFx1Nzg2RVx1NEZERFx1NEUwRFx1NEYxQVx1OEQ4NVx1NTFGQVx1NjU4N1x1Njg2M1x1ODMwM1x1NTZGNFxuICAgICAgICB0YXJnZXRMaW5lTnVtYmVyID0gTWF0aC5taW4odGFyZ2V0TGluZU51bWJlciwgZG9jLmxpbmVzICsgMSk7XG5cbiAgICAgICAgY29uc3QgcmVjdCA9IHZpZXcuY29vcmRzQXRQb3MocGxhY2Vob2xkZXJQb3MpO1xuICAgICAgICBpZiAoIXJlY3QpIHJldHVybjtcblxuICAgICAgICBjb25zdCBsaW5lRWxlbWVudCA9IHZpZXcuZG9tLnF1ZXJ5U2VsZWN0b3IoJy5jbS1saW5lJyk7XG4gICAgICAgIGlmICghbGluZUVsZW1lbnQpIHJldHVybjtcblxuICAgICAgICBjb25zdCBsaW5lUmVjdCA9IGxpbmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSBgJHtsaW5lUmVjdC5sZWZ0fXB4YDtcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLndpZHRoID0gYCR7bGluZVJlY3Qud2lkdGh9cHhgO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzJweCc7XG5cbiAgICAgICAgLy8gXHU4QkJFXHU3RjZFXHU1MzYwXHU0RjREXHU3QjI2XHU3Njg0XHU1NzgyXHU3NkY0XHU0RjREXHU3RjZFXG4gICAgICAgIGlmICh0YXJnZXRMaW5lTnVtYmVyID09PSBmaXJzdENvbnRlbnRMaW5lTnVtYmVyKSB7XG4gICAgICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTY2MkZcdTU3MjhcdTdCMkNcdTRFMDBcdTRFMkFcdTUxODVcdTVCQjlcdTg4NENcdUZGMENcdTVDMDZcdTUzNjBcdTRGNERcdTdCMjZcdTY1M0VcdTU3MjhcdTUxNzZcdTRFMEFcdTY1QjlcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0Q29udGVudExpbmVSZWN0ID0gdmlldy5jb29yZHNBdFBvcyhwbGFjZWhvbGRlclBvcyk7XG4gICAgICAgICAgICBpZiAoZmlyc3RDb250ZW50TGluZVJlY3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gYCR7Zmlyc3RDb250ZW50TGluZVJlY3QudG9wIC0gMn1weGA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0TGluZU51bWJlciA+IGRvYy5saW5lcykge1xuICAgICAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU2NjJGXHU1NzI4XHU2NTg3XHU2ODYzXHU2NzJCXHU1QzNFXHVGRjBDXHU1QzA2XHU1MzYwXHU0RjREXHU3QjI2XHU2NTNFXHU1NzI4XHU2NzAwXHU1NDBFXHU0RTAwXHU4ODRDXHU0RTBCXHU2NUI5XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0gYCR7cmVjdC5ib3R0b20gKyAyfXB4YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFx1NTE3Nlx1NEVENlx1NjI0MFx1NjcwOVx1NjBDNVx1NTFCNVx1RkYwQ1x1NTMwNVx1NjJFQ1x1N0E3QVx1NzY3RFx1ODg0Q1xuICAgICAgICAgICAgY29uc3QgY3VycmVudExpbmVSZWN0ID0gdmlldy5jb29yZHNBdFBvcyhsaW5lLmZyb20pO1xuICAgICAgICAgICAgY29uc3QgbmV4dExpbmVSZWN0ID0gdmlldy5jb29yZHNBdFBvcyhkb2MubGluZSh0YXJnZXRMaW5lTnVtYmVyKS5mcm9tKTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50TGluZVJlY3QgJiYgbmV4dExpbmVSZWN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLnRvcCA9IGAkeyhjdXJyZW50TGluZVJlY3QuYm90dG9tICsgbmV4dExpbmVSZWN0LnRvcCkgLyAyfXB4YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY3VycmVudFBvc2l0aW9uID0gcGxhY2Vob2xkZXJQb3M7XG4gICAgICAgIHRoaXMudGFyZ2V0TGluZSA9IHRhcmdldExpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuc291cmNlTGluZU51bWJlciA9IHNvdXJjZUxpbmVOdW1iZXI7XG5cbiAgICB9XG5cbiAgICAvLyA0LiBcdTk2OTBcdTg1Q0ZcdTYyRDZcdTUyQThcdTUzNjBcdTRGNERcdTdCMjZcbiAgICBoaWRlRHJhZ1BsYWNlaG9sZGVyKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgdGhpcy5jdXJyZW50UG9zaXRpb24gPSBudWxsO1xuICAgICAgICB0aGlzLnRhcmdldExpbmUgPSBudWxsO1xuICAgICAgICB0aGlzLnNvdXJjZUxpbmVOdW1iZXIgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIDUuIFx1ODNCN1x1NTNENlx1NTM2MFx1NEY0RFx1N0IyNlx1NEY0RFx1N0Y2RVxuICAgIGdldFBsYWNlaG9sZGVyUG9zaXRpb24oKTogbnVtYmVyIHwgbnVsbCB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRQb3NpdGlvbjtcbiAgICB9XG5cbiAgICAvLyA2LiBcdTgzQjdcdTUzRDZcdTc2RUVcdTY4MDdcdTg4NENcdTUzRjdcbiAgICBnZXRUYXJnZXRMaW5lKCk6IG51bWJlciB8IG51bGwge1xuICAgICAgICByZXR1cm4gdGhpcy50YXJnZXRMaW5lO1xuICAgIH1cblxuICAgIC8vIDcuIFx1ODNCN1x1NTNENlx1NkU5MFx1ODg0Q1x1NTNGN1xuICAgIGdldFNvdXJjZUxpbmVOdW1iZXIoKTogbnVtYmVyIHwgbnVsbCB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvdXJjZUxpbmVOdW1iZXI7XG4gICAgfVxufSIsICJpbXBvcnQgeyBXaWRnZXRUeXBlLCBWaWV3VXBkYXRlLCBWaWV3UGx1Z2luLCBEZWNvcmF0aW9uU2V0LCBEZWNvcmF0aW9uLCBFZGl0b3JWaWV3IH0gZnJvbSAnQGNvZGVtaXJyb3Ivdmlldyc7XG5pbXBvcnQgeyBTdGF0ZUZpZWxkLCBTdGF0ZUVmZmVjdCB9IGZyb20gJ0Bjb2RlbWlycm9yL3N0YXRlJztcblxuLy8gMS4gXHU2MkQ2XHU1MkE4XHU2MjRCXHU2N0M0XHU1QzBGXHU5MEU4XHU0RUY2XHU3QzdCXG5jbGFzcyBEcmFnSGFuZGxlV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG4gICAgdG9ET00oKSB7XG4gICAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgICAgc3Bhbi5jbGFzc05hbWUgPSBcImNtLWRyYWctaGFuZGxlci1jb250YWluZXJcIjtcbiAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGUoXCJkcmFnZ2FibGVcIiwgXCJ0cnVlXCIpO1xuICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZShcImNvbnRlbnRlZGl0YWJsZVwiLCBcImZhbHNlXCIpO1xuICAgICAgICBzcGFuLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2xpY2thYmxlLWljb25cIj5cbiAgICAgICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgY2xhc3M9XCJzdmctaWNvbiBsdWNpZGUtZ3JpcC12ZXJ0aWNhbFwiPlxuICAgICAgICAgICAgICAgICAgICA8Y2lyY2xlIGN4PVwiOVwiIGN5PVwiMTJcIiByPVwiMVwiPjwvY2lyY2xlPlxuICAgICAgICAgICAgICAgICAgICA8Y2lyY2xlIGN4PVwiOVwiIGN5PVwiNVwiIHI9XCIxXCI+PC9jaXJjbGU+XG4gICAgICAgICAgICAgICAgICAgIDxjaXJjbGUgY3g9XCI5XCIgY3k9XCIxOVwiIHI9XCIxXCI+PC9jaXJjbGU+XG4gICAgICAgICAgICAgICAgICAgIDxjaXJjbGUgY3g9XCIxNVwiIGN5PVwiMTJcIiByPVwiMVwiPjwvY2lyY2xlPlxuICAgICAgICAgICAgICAgICAgICA8Y2lyY2xlIGN4PVwiMTVcIiBjeT1cIjVcIiByPVwiMVwiPjwvY2lyY2xlPlxuICAgICAgICAgICAgICAgICAgICA8Y2lyY2xlIGN4PVwiMTVcIiBjeT1cIjE5XCIgcj1cIjFcIj48L2NpcmNsZT5cbiAgICAgICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgYDtcbiAgICAgICAgcmV0dXJuIHNwYW47XG4gICAgfVxufVxuXG4vLyAyLiBcdTcyQjZcdTYwMDFcdTY1NDhcdTY3OUNcdTVCOUFcdTRFNDlcbmNvbnN0IGFkZERyYWdIYW5kbGUgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8e2Zyb206IG51bWJlciwgdG86IG51bWJlcn0+KCk7XG5jb25zdCBzZXREcmFnZ2luZ0xpbmUgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8bnVtYmVyIHwgbnVsbD4oKTtcblxuLy8gMy4gXHU2MkQ2XHU1MkE4XHU2MjRCXHU2N0M0XHU3MkI2XHU2MDAxXHU1QjU3XHU2QkI1XG5jb25zdCBkcmFnSGFuZGxlRmllbGQgPSBTdGF0ZUZpZWxkLmRlZmluZTxEZWNvcmF0aW9uU2V0Pih7XG4gICAgY3JlYXRlKCkge1xuICAgICAgICByZXR1cm4gRGVjb3JhdGlvbi5ub25lO1xuICAgIH0sXG4gICAgdXBkYXRlKGhhbmRsZXMsIHRyKSB7XG4gICAgICAgIGhhbmRsZXMgPSBoYW5kbGVzLm1hcCh0ci5jaGFuZ2VzKTtcbiAgICAgICAgZm9yIChsZXQgZSBvZiB0ci5lZmZlY3RzKSB7XG4gICAgICAgICAgICBpZiAoZS5pcyhhZGREcmFnSGFuZGxlKSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZXMgPSBoYW5kbGVzLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGFkZDogW0RlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldDogbmV3IERyYWdIYW5kbGVXaWRnZXQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZGU6IC0xXG4gICAgICAgICAgICAgICAgICAgIH0pLnJhbmdlKGUudmFsdWUuZnJvbSldXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhhbmRsZXM7XG4gICAgfSxcbiAgICBwcm92aWRlOiBmID0+IEVkaXRvclZpZXcuZGVjb3JhdGlvbnMuZnJvbShmKVxufSk7XG5cbi8vIDQuIFx1NjJENlx1NTJBOFx1ODg0Q1x1NzJCNlx1NjAwMVx1NUI1N1x1NkJCNVxuY29uc3QgZHJhZ2dpbmdMaW5lRmllbGQgPSBTdGF0ZUZpZWxkLmRlZmluZTxudW1iZXIgfCBudWxsPih7XG4gICAgY3JlYXRlKCkgeyByZXR1cm4gbnVsbDsgfSxcbiAgICB1cGRhdGUodmFsdWUsIHRyKSB7XG4gICAgICAgIGZvciAobGV0IGUgb2YgdHIuZWZmZWN0cykge1xuICAgICAgICAgICAgaWYgKGUuaXMoc2V0RHJhZ2dpbmdMaW5lKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHByb3ZpZGU6IGYgPT4gRWRpdG9yVmlldy5kZWNvcmF0aW9ucy5mcm9tKGYsIHZhbHVlID0+IHtcbiAgICAgICAgcmV0dXJuICh2aWV3OiBFZGl0b3JWaWV3KSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHJldHVybiBEZWNvcmF0aW9uLm5vbmU7XG4gICAgICAgICAgICBsZXQgbGluZSA9IHZpZXcuc3RhdGUuZG9jLmxpbmUodmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIERlY29yYXRpb24uc2V0KERlY29yYXRpb24ubGluZSh7IGNsYXNzOiBcImNtLWRyYWdnaW5nLWxpbmVcIiB9KS5yYW5nZShsaW5lLmZyb20pKTtcbiAgICAgICAgfTtcbiAgICB9KVxufSk7XG5cbi8vIDUuIFx1NjJENlx1NTJBOFx1NjI0Qlx1NjdDNFx1NjNEMlx1NEVGNlxuY29uc3QgZHJhZ0hhbmRsZVBsdWdpbiA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKGNsYXNzIHtcbiAgICBkZWNvcmF0aW9uczogRGVjb3JhdGlvblNldDtcblxuICAgIGNvbnN0cnVjdG9yKHZpZXc6IEVkaXRvclZpZXcpIHtcbiAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuY3JlYXRlRGVjb3JhdGlvbnModmlldyk7XG4gICAgfVxuXG4gICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuICAgICAgICBpZiAodXBkYXRlLmRvY0NoYW5nZWQgfHwgdXBkYXRlLnZpZXdwb3J0Q2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuY3JlYXRlRGVjb3JhdGlvbnModXBkYXRlLnZpZXcpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY3JlYXRlRGVjb3JhdGlvbnModmlldzogRWRpdG9yVmlldykge1xuICAgICAgICBsZXQgd2lkZ2V0cyA9IFtdO1xuICAgICAgICBmb3IgKGxldCB7ZnJvbSwgdG99IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xuICAgICAgICAgICAgZm9yIChsZXQgcG9zID0gZnJvbTsgcG9zIDw9IHRvOykge1xuICAgICAgICAgICAgICAgIGxldCBsaW5lID0gdmlldy5zdGF0ZS5kb2MubGluZUF0KHBvcyk7XG4gICAgICAgICAgICAgICAgd2lkZ2V0cy5wdXNoKERlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0OiBuZXcgRHJhZ0hhbmRsZVdpZGdldCgpLFxuICAgICAgICAgICAgICAgICAgICBzaWRlOiAtMVxuICAgICAgICAgICAgICAgIH0pLnJhbmdlKGxpbmUuZnJvbSkpO1xuICAgICAgICAgICAgICAgIHBvcyA9IGxpbmUudG8gKyAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBEZWNvcmF0aW9uLnNldCh3aWRnZXRzKTtcbiAgICB9XG59LCB7XG4gICAgZGVjb3JhdGlvbnM6IHYgPT4gdi5kZWNvcmF0aW9uc1xufSk7XG5cbmV4cG9ydCB7IGRyYWdIYW5kbGVGaWVsZCwgZHJhZ2dpbmdMaW5lRmllbGQsIGRyYWdIYW5kbGVQbHVnaW4sIHNldERyYWdnaW5nTGluZSB9OyIsICJpbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSAnQGNvZGVtaXJyb3Ivdmlldyc7XG5pbXBvcnQgeyBFZGl0b3JTZWxlY3Rpb24gfSBmcm9tICdAY29kZW1pcnJvci9zdGF0ZSc7XG5cbmV4cG9ydCBjbGFzcyBCbG9ja01vdmVyIHtcbiAgICAvLyBcdTZBMjFcdTU3NTdcdTdGMTZcdTUzRjdcdUZGMUExXG4gICAgLy8gXHU1MjlGXHU4MEZEXHVGRjFBXHU3OUZCXHU1MkE4XHU2NTg3XHU2NzJDXHU1NzU3XG4gICAgLy8gXHU4RjkzXHU1MTY1XHVGRjFBdmlldyAoRWRpdG9yVmlldyksIGZyb21MaW5lIChudW1iZXIpLCB0b0xpbmUgKG51bWJlcilcbiAgICAvLyBcdThGOTNcdTUxRkFcdUZGMUFcdTY1RTBcbiAgICBzdGF0aWMgbW92ZUJsb2NrKHZpZXc6IEVkaXRvclZpZXcsIGZyb21MaW5lOiBudW1iZXIsIHRvTGluZTogbnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IGRvYyA9IHZpZXcuc3RhdGUuZG9jO1xuICAgICAgICBjb25zdCB0b3RhbExpbmVzID0gZG9jLmxpbmVzO1xuXG4gICAgICAgIC8vIFx1Nzg2RVx1NEZERFx1ODg0Q1x1NTNGN1x1NTcyOFx1NjcwOVx1NjU0OFx1ODMwM1x1NTZGNFx1NTE4NVxuICAgICAgICBmcm9tTGluZSA9IE1hdGgubWF4KDEsIE1hdGgubWluKGZyb21MaW5lLCB0b3RhbExpbmVzKSk7XG4gICAgICAgIHRvTGluZSA9IE1hdGgubWF4KDEsIE1hdGgubWluKHRvTGluZSwgdG90YWxMaW5lcyArIDEpKTtcblxuICAgICAgICAvLyBcdTY4QzBcdTY3RTVcdTY2MkZcdTU0MjZcdTY2MkZcdTc2RjhcdTkwQkJcdTg4NENcdTc5RkJcdTUyQThcdTc2ODRcdTYwQzVcdTUxQjVcbiAgICAgICAgaWYgKHRvTGluZSA9PT0gZnJvbUxpbmUgKyAxIHx8IGZyb21MaW5lID09PSB0b0xpbmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZyb21MaW5lQ29udGVudCA9IGRvYy5saW5lKGZyb21MaW5lKTtcbiAgICAgICAgY29uc3QgbGluZUNvbnRlbnQgPSBmcm9tTGluZUNvbnRlbnQudGV4dDtcblxuICAgICAgICBsZXQgY2hhbmdlcyA9IFtdO1xuICAgICAgICBsZXQgaW5zZXJ0UG9zO1xuICAgICAgICBsZXQgbmV3Q3Vyc29yUG9zO1xuXG4gICAgICAgIGlmICh0b0xpbmUgPiBmcm9tTGluZSkge1xuICAgICAgICAgICAgLy8gXHU1NDExXHU0RTBCXHU3OUZCXHU1MkE4XG4gICAgICAgICAgICBpZiAodG9MaW5lID4gdG90YWxMaW5lcykge1xuICAgICAgICAgICAgICAgIC8vIFx1NzlGQlx1NTJBOFx1NTIzMFx1NjU4N1x1Njg2M1x1NjcyQlx1NUMzRVxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lID0gZG9jLmxpbmUodG90YWxMaW5lcyk7XG4gICAgICAgICAgICAgICAgaW5zZXJ0UG9zID0gbGFzdExpbmUudG87XG4gICAgICAgICAgICAgICAgY2hhbmdlcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgeyBmcm9tOiBpbnNlcnRQb3MsIGluc2VydDogJ1xcbicgKyBsaW5lQ29udGVudCB9LFxuICAgICAgICAgICAgICAgICAgICB7IGZyb206IGZyb21MaW5lQ29udGVudC5mcm9tLCB0bzogZnJvbUxpbmVDb250ZW50LnRvICsgKGZyb21MaW5lID09PSB0b3RhbExpbmVzID8gMCA6IDEpLCBpbnNlcnQ6ICcnIH1cbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIG5ld0N1cnNvclBvcyA9IGluc2VydFBvcyArIGxpbmVDb250ZW50Lmxlbmd0aCArIDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldExpbmUgPSBkb2MubGluZSh0b0xpbmUgLSAxKTtcbiAgICAgICAgICAgICAgICBpbnNlcnRQb3MgPSB0YXJnZXRMaW5lLnRvO1xuICAgICAgICAgICAgICAgIGNoYW5nZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHsgZnJvbTogaW5zZXJ0UG9zLCBpbnNlcnQ6ICdcXG4nICsgbGluZUNvbnRlbnQgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBmcm9tOiBmcm9tTGluZUNvbnRlbnQuZnJvbSwgdG86IGZyb21MaW5lQ29udGVudC50byArIDEsIGluc2VydDogJycgfVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgbmV3Q3Vyc29yUG9zID0gaW5zZXJ0UG9zICsgbGluZUNvbnRlbnQubGVuZ3RoICsgMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFx1NTQxMVx1NEUwQVx1NzlGQlx1NTJBOFxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0TGluZSA9IGRvYy5saW5lKHRvTGluZSAtIDEpO1xuICAgICAgICAgICAgaW5zZXJ0UG9zID0gdGFyZ2V0TGluZS50bztcblxuICAgICAgICAgICAgaWYgKGZyb21MaW5lID09PSB0b3RhbExpbmVzKSB7XG4gICAgICAgICAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU2NjJGXHU2NzAwXHU1NDBFXHU0RTAwXHU4ODRDXHU1NDExXHU0RTBBXHU3OUZCXHU1MkE4LFx1NzZGNFx1NjNBNVx1NTIyMFx1OTY2NFx1NjcwMFx1NTQwRVx1NEUwMFx1ODg0Q1x1NTE4NVx1NUJCOVx1MzAwMlxuICAgICAgICAgICAgICAgIGNvbnN0IHNlY29uZExhc3RMaW5lID0gZG9jLmxpbmUodG90YWxMaW5lcyAtIDEpO1xuICAgICAgICAgICAgICAgIGNoYW5nZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHsgZnJvbTogaW5zZXJ0UG9zLCBpbnNlcnQ6ICdcXG4nICsgbGluZUNvbnRlbnQgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBmcm9tOiBzZWNvbmRMYXN0TGluZS50bywgdG86IGRvYy5sZW5ndGggfVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHsgZnJvbTogaW5zZXJ0UG9zLCBpbnNlcnQ6ICdcXG4nICsgbGluZUNvbnRlbnQgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBmcm9tOiBmcm9tTGluZUNvbnRlbnQuZnJvbSwgdG86IGZyb21MaW5lQ29udGVudC50byArIDEsIGluc2VydDogJycgfVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdDdXJzb3JQb3MgPSBpbnNlcnRQb3MgKyBsaW5lQ29udGVudC5sZW5ndGggKyAxO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmlldy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgY2hhbmdlczogY2hhbmdlcyxcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb246IEVkaXRvclNlbGVjdGlvbi5jdXJzb3IoTWF0aC5taW4obmV3Q3Vyc29yUG9zLCBkb2MubGVuZ3RoKSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gY29uc29sZS5lcnJvcignXHU3OUZCXHU1MkE4XHU1NzU3XHU2NUY2XHU1MUZBXHU5NTE5OicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSAnQGNvZGVtaXJyb3Ivdmlldyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFZGl0b3JWaWV3KGFwcDogQXBwKTogRWRpdG9yVmlldyB8IG51bGwge1xuICAgIGNvbnN0IHZpZXcgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICBpZiAoIXZpZXcpIHJldHVybiBudWxsO1xuICAgIHJldHVybiAodmlldy5lZGl0b3IgYXMgYW55KS5jbTtcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQXVCOzs7QUNFdkIsc0JBQTBDOzs7QUNBbkMsSUFBTSxrQkFBTixNQUFzQjtBQUFBLEVBTXpCLGNBQWM7QUFKZCxTQUFRLGtCQUFpQztBQUN6QyxTQUFRLGFBQTRCO0FBQ3BDLFNBQVEsbUJBQWtDO0FBR3RDLFNBQUssVUFBVSxLQUFLLDZCQUE2QjtBQUNqRCxhQUFTLEtBQUssWUFBWSxLQUFLLE9BQU87QUFBQSxFQUMxQztBQUFBLEVBRUEsQUFBUSwrQkFBNEM7QUFDaEQsVUFBTSxrQkFBa0IsU0FBUyxjQUFjLEtBQUs7QUFDcEQsb0JBQWdCLFlBQVk7QUFDNUIsb0JBQWdCLE1BQU0sV0FBVztBQUNqQyxvQkFBZ0IsTUFBTSxTQUFTO0FBQy9CLG9CQUFnQixNQUFNLGtCQUFrQjtBQUN4QyxvQkFBZ0IsTUFBTSxVQUFVO0FBQ2hDLG9CQUFnQixNQUFNLFNBQVM7QUFDL0IsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQU1BLEFBQVEsd0JBQXdCLEtBQWtCO0FBQzlDLFFBQUksWUFBWTtBQUNoQixVQUFNLFlBQVksSUFB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
